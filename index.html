<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>BeliefExplorer – Questionnaire sur les croyances personnelles</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --accent: #0066cc;
            --accent-light: #4d94ff;
            --bg: #f7f9fc;
            --card: #ffffff;
            --text: #222;
            --muted: #666;
            --border: #e1e4e8;
            --success: #28a745;
            --danger: #dc3545;
            --bar: #ffcc00;
        }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.55;
        }
        header, main, footer {
            max-width: 960px;
            margin: auto;
            padding: 1.2rem 1rem;
        }
        h1 {
            font-size: 1.8rem;
            margin: 0 0 .5rem;
            color: var(--accent);
        }
        .intro {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem 1.2rem;
            margin-bottom: 1.5rem;
            font-size: .95rem;
        }
        .belief-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: .75rem;
            display: flex;
            flex-wrap: wrap;
            gap: .8rem;
            align-items: center;
        }
        .belief-card.disabled {
            opacity: .55;
        }
        .belief-text {
            flex: 1 1 260px;
            font-weight: 500;
        }
        .belief-card input[type="checkbox"] {
            transform: scale(1.2);
            accent-color: var(--accent);
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: .6rem;
            align-items: center;
        }
        .controls label {
            font-size: .8rem;
            color: var(--muted);
            margin-right: .3rem;
        }
        .controls input[type="range"] {
            width: 100px;
        }
        .controls output {
            min-width: 38px;
            font-weight: 600;
            font-size: .9rem;
            color: var(--accent);
        }
        .actions {
            margin: 1.5rem 0;
            display: flex;
            flex-wrap: wrap;
            gap: .8rem;
        }
        button {
            border: none;
            border-radius: 6px;
            padding: .6rem 1.1rem;
            font-size: 1rem;
            cursor: pointer;
            transition: background .2s;
        }
        .primary {
            background: var(--accent);
            color: #fff;
        }
        .primary:hover {
            background: var(--accent-light);
        }
        .secondary {
            background: var(--border);
            color: var(--text);
        }
        .secondary:hover {
            background: #d0d7de;
        }
        .danger {
            background: var(--danger);
            color: #fff;
        }
        .danger:hover {
            background: #c82333;
        }
        #results {
            margin-top: 2rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: .9rem;
        }
        th, td {
            padding: .55rem .5rem;
            border: 1px solid var(--border);
            text-align: left;
        }
        th {
            background: var(--bg);
            cursor: pointer;
            user-select: none;
        }
        th:hover {
            background: #e9ecef;
        }
        tr.top10 {
            background: #fffbe6;
        }
        .bar {
            display: inline-block;
            height: 10px;
            background: var(--bar);
            border-radius: 2px;
            margin-left: 6px;
        }
        @media (max-width: 600px) {
            .belief-card {
                flex-direction: column;
                align-items: flex-start;
            }
            .controls {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>BeliefExplorer</h1>
        <p>Questionnaire personnel pour explorer vos croyances</p>
    </header>

    <main>
        <section class="intro" aria-label="Présentation">
            <p>Cet outil est un questionnaire personnel pour explorer vos croyances. Les données restent stockées localement dans votre navigateur. Aucune information n’est transmise à un serveur.</p>
        </section>

        <form id="beliefForm" aria-label="Croyances">
            <div id="beliefList" role="group" aria-label="Liste des croyances"></div>

            <div class="actions">
                <button type="button" class="primary" id="analyzeBtn">Analyser maintenant</button>
                <button type="button" class="secondary" id="exportBtn">Exporter JSON</button>
                <button type="button" class="danger" id="clearBtn">Effacer mes données</button>
            </div>
        </form>

        <section id="results" aria-label="Résultats" hidden>
            <h2>Résultats</h2>
            <p>Cliquez sur les en-têtes pour trier. Les 10 croyances les plus importantes sont mises en évidence.</p>
            <div style="overflow-x:auto;">
                <table id="resultTable" aria-label="Tableau des résultats">
                    <thead>
                        <tr>
                            <th data-key="text">Croyance ↕</th>
                            <th data-key="agreement">Accord ↕</th>
                            <th data-key="certainty">Certitude ↕</th>
                            <th data-key="emotion">Émotion ↕</th>
                            <th data-key="score">Importance ↕</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
    </main>

    <footer style="text-align:center;font-size:.8rem;color:var(--muted);padding:2rem 1rem;">
        BeliefExplorer – 2025 – Code open-source (CC0)
    </footer>

    <script>
        /* ===== LISTE DES 100 CROYANCES ===== */
        const BELIEFS = [
            "Il faut travailler dur pour réussir sa vie.",
            "L’argent fait le bonheur.",
            "L’échec est une opportunité d’apprentissage.",
            "Les traditions doivent être respectées.",
            "On ne change pas sa nature profonde.",
            "La santé est plus importante que la richesse.",
            "Le succès dépend surtout de la chance.",
            "Les émotions doivent être contrôlées pour être respecté(e).",
            "Aider les autres est une priorité.",
            "Le bonheur vient des relations humaines.",
            "La famille est le pilier de la vie.",
            "L’amitié doit être entretenue régulièrement.",
            "Les règles sociales sont indispensables à la cohésion.",
            "L’éducation est la clé de l’émancipation.",
            "Le respect s’acquiert par l’autorité.",
            "Le travail en équipe est plus efficace que le travail solitaire.",
            "Il est normal de se comparer aux autres.",
            "La réussite professionnelle détermine la valeur d’une personne.",
            "Les personnes riches ont plus d’influence morale.",
            "La politique ne sert à rien.",
            "Chaque vote compte.",
            "Les hommes politiques sont corrompus.",
            "La liberté d’expression est absolue.",
            "L’État doit protéger les plus faibles.",
            "L’impôt est une contrainte juste.",
            "La monogamie est naturelle.",
            "L’amour véritable dure toute la vie.",
            "Le mariage est un engagement sacré.",
            "Les enfants doivent honorer leurs parents.",
            "Les parents doivent tout donner à leurs enfants.",
            "La discipline est essentielle à l’éducation.",
            "Le numérique rend les gens plus seuls.",
            "La technologie améliore la qualité de vie.",
            "Les réseaux sociaux créent de la dépendance.",
            "La vie sans internet est possible.",
            "La nature doit être préservée à tout prix.",
            "L’homme est supérieur aux autres espèces.",
            "Le climat évolue indépendamment de l’humain.",
            "Chaque geste compte pour l’environnement.",
            "La science explique tout.",
            "La religion apporte du sens.",
            "La spiritualité est personnelle.",
            "Les miracles existent.",
            "La méditation améliore la santé mentale.",
            "Le destin est écrit.",
            "On est maître de son destin.",
            "La chance se provoque.",
            "Le risque est nécessaire pour progresser.",
            "La sécurité est plus importante que l’aventure.",
            "Les voyages forment la jeunesse.",
            "Chacun peut apprendre de ses erreurs.",
            "Le pardon libère celui qui pardonne.",
            "La vengeance est parfois salutaire.",
            "La justice est toujours rendue.",
            "La police est là pour protéger.",
            "La prison réhabilite.",
            "La peine de mort est inacceptable.",
            "La liberté vaut mieux que la sécurité.",
            "L’art est un luxe.",
            "La culture rapproche les peuples.",
            "Le sport enseigne la discipline.",
            "La compétition stimule l’excellence.",
            "La coopération est préférable à la compétition.",
            "L’échec scolaire condamne l’avenir.",
            "Le diplôme garantit une bonne situation.",
            "L’intelligence est innée.",
            "On peut devenir plus intelligent.",
            "La créativité s’apprend.",
            "Les émotions sont des faiblesses.",
            "Montrer ses émotions est un signe de courage.",
            "Les hommes sont plus rationnels que les femmes.",
            "Les femmes sont plus empathiques que les hommes.",
            "L’égalité hommes-femmes est atteinte.",
            "Le féminisme est encore nécessaire.",
            "Les stéréotypes ont un fond de vérité.",
            "Chacun peut changer.",
            "Le passé détermine le présent.",
            "Il faut vivre avec son temps.",
            "Les anciens ont toujours raison.",
            "Les jeunes comprennent le monde moderne.",
            "L’âge apporte la sagesse.",
            "La retraite est méritée.",
            "Travailler moins vivra mieux.",
            "La productivité est la clé du progrès.",
            "Le chômage est souvent un choix.",
            "Les pauvres sont responsables de leur situation.",
            "La société doit garantir un revenu minimum.",
            "L’entrepreneuriat est accessible à tous.",
            "Les riches créent des emplois.",
            "La spéculation est nuisible.",
            "L’investissement est un acte courageux.",
            "L’argent doit circuler.",
            "L’épargne est une preuve de responsabilité.",
            "Le crédit permet de réaliser ses rêves.",
            "La dette est un danger.",
            "Il faut profiter de la vie immédiatement.",
            "Reporter son bonheur est sage.",
            "Le bonheur est un choix.",
            "La gratitude améliore le bien-être.",
            "Le stress est inévitable.",
            "La maladie est un signe de faiblesse.",
            "La prévention vaut mieux que le remède.",
            "La médecine moderne est fiable.",
            "Les médecines alternatives ont leur place.",
            "La mort fait peur.",
            "Il faut parler de la mort ouvertement.",
            "La vie a un sens.",
            "Le sens se crée par les actes.",
            "La solitude est néfaste.",
            "La solitude permet de se retrouver.",
            "Les autres nous définissent.",
            "On se définit seul."
        ];

        /* ===== STATE ===== */
        let beliefs = []; // sera rempli avec les objets complets
        let sortState = { key: 'score', asc: false };

        /* ===== INIT ===== */
        function init() {
            const stored = localStorage.getItem('beliefExplorer');
            if (stored) {
                try { beliefs = JSON.parse(stored); } catch (e) { beliefs = []; }
            }
            renderBeliefs();
            document.getElementById('analyzeBtn').addEventListener('click', analyze);
            document.getElementById('exportBtn').addEventListener('click', exportJSON);
            document.getElementById('clearBtn').addEventListener('click', clearData);
            document.querySelectorAll('th[data-key]').forEach(th => {
                th.addEventListener('click', () => sortTable(th.dataset.key));
            });
        }

        /* ===== RENDER ===== */
        function renderBeliefs() {
            const container = document.getElementById('beliefList');
            container.innerHTML = '';
            BELIEFS.forEach((text, idx) => {
                const existing = beliefs.find(b => b.id === idx);
                const checked = existing ? 'checked' : '';
                const agreement = existing ? existing.agreement : 4;
                const certainty = existing ? existing.certainty : 50;
                const emotion = existing ? existing.emotion : 4;

                const card = document.createElement('div');
                card.className = 'belief-card';
                if (!checked) card.classList.add('disabled');
                card.innerHTML = `
                    <input type="checkbox" id="b${idx}" ${checked} aria-label="Sélectionner cette croyance">
                    <label for="b${idx}" class="belief-text">${text}</label>
                    <div class="controls">
                        <label>Accord 1-7</label>
                        <input type="range" min="1" max="7" value="${agreement}" aria-label="Accord">
                        <output>${agreement}</output>

                        <label>Certitude %</label>
                        <input type="range" min="0" max="100" value="${certainty}" aria-label="Certitude">
                        <output>${certainty}%</output>

                        <label>Émotion 1-7</label>
                        <input type="range" min="1" max="7" value="${emotion}" aria-label="Intensité émotionnelle">
                        <output>${emotion}</output>
                    </div>
                `;
                const chk = card.querySelector('input[type="checkbox"]');
                chk.addEventListener('change', () => {
                    card.classList.toggle('disabled', !chk.checked);
                    saveBelief(idx, text, chk.checked, card);
                });
                card.querySelectorAll('input[type="range"]').forEach(sl => {
                    sl.addEventListener('input', () => {
                        sl.nextElementSibling.textContent = sl.value + (sl.parentElement.querySelector('label').textContent.includes('%') ? '%' : '');
                        if (chk.checked) saveBelief(idx, text, true, card);
                    });
                });
                container.appendChild(card);
            });
        }

        /* ===== SAVE SINGLE ===== */
        function saveBelief(id, text, selected, card) {
            const others = beliefs.filter(b => b.id !== id);
            if (selected) {
                const agreement = parseInt(card.querySelectorAll('input[type="range"]')[0].value);
                const certainty = parseInt(card.querySelectorAll('input[type="range"]')[1].value);
                const emotion = parseInt(card.querySelectorAll('input[type="range"]')[2].value);
                const score = computeScore(agreement, certainty, emotion);
                others.push({ id, text, agreement, certainty, emotion, score });
            }
            beliefs = others;
            localStorage.setItem('beliefExplorer', JSON.stringify(beliefs));
        }

        /* ===== COMPUTE ===== */
        function computeScore(a, c, e) {
            const normA = (a - 1) / 6;
            const normE = (e - 1) / 6;
            const score = (normA * (c / 100) * (1 + 0.2 * normE));
            return Math.round(score * 100) / 100;
        }

        /* ===== ANALYZE ===== */
        function analyze() {
            if (beliefs.length === 0) {
                alert("Veuillez sélectionner au moins une croyance.");
                return;
            }
            const tbody = document.querySelector('#resultTable tbody');
            tbody.innerHTML = '';
            const sorted = [...beliefs].sort((a, b) => b.score - a.score);
            sorted.forEach((b, i) => {
                const tr = document.createElement('tr');
                if (i < 10) tr.classList.add('top10');
                const bar = `<span class="bar" style="width:${Math.max(4, b.score * 200)}px"></span>`;
                tr.innerHTML = `
                    <td>${b.text}</td>
                    <td>${b.agreement}</td>
                    <td>${b.certainty}%</td>
                    <td>${b.emotion}</td>
                    <td>${b.score}${bar}</td>
                `;
                tbody.appendChild(tr);
            });
            document.getElementById('results').hidden = false;
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        /* ===== SORT ===== */
        function sortTable(key) {
            if (sortState.key === key) sortState.asc = !sortState.asc;
            else { sortState.key = key; sortState.asc = false; }
            beliefs.sort((a, b) => {
                const va = a[key], vb = b[key];
                const res = (typeof va === 'string' ? va.localeCompare(vb) : va - vb);
                return sortState.asc ? res : -res;
            });
            analyze(); // re-render
        }

        /* ===== EXPORT ===== */
        function exportJSON() {
            const blob = new Blob([JSON.stringify(beliefs, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'beliefExplorer_donnees.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        /* ===== CLEAR ===== */
        function clearData() {
            if (!confirm("Supprimer toutes vos données locales ?")) return;
            localStorage.removeItem('beliefExplorer');
            beliefs = [];
            renderBeliefs();
            document.getElementById('results').hidden = true;
        }

        /* ===== GO ===== */
        init();
    </script>
</body>
</html>
